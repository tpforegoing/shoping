# Аналіз проекту Shoping

## Загальна структура проекту

Проект складається з двох основних частин:

### Бекенд (Django)
- Використовує Django 5.2 з Django REST Framework
- Аутентифікація через Knox (токени)
- Налаштування середовища через django-environ
- Підтримка різних середовищ (dev, prod)

### Фронтенд (Angular)
- Angular 19.2.7
- Використовує NgRx для управління станом
- Angular Material для UI компонентів
- Підтримка маршрутизації та лейаутів

## Бекенд (Django)

### Архітектура бази даних

Основою системи є абстрактна модель `Thing`, від якої успадковуються інші моделі:

1. **Користувачі та ролі**:
   - `CustomUser` - розширює стандартного користувача Django з додаванням ролей
   - Ролі: `CLIENT` та `MANAGER`

2. **Продукти та категорії**:
   - `ProductCategory` - категорії продуктів з ієрархічною структурою
   - `Product` - продукти, які можуть мати батьківський продукт та категорію
   - `Price` - ціни на продукти з періодом дії

3. **Клієнти та замовлення**:
   - `Customer` - інформація про клієнта, пов'язана з користувачем
   - `Order` - замовлення з різними статусами
   - `OrderItem` - елементи замовлення з кількістю та ціною на момент замовлення

### API ендпоінти

Бекенд надає RESTful API через Django REST Framework:

- `/api/products/` - управління продуктами
- `/api/category/` - управління категоріями
- `/api/price/` - управління цінами
- `/api/customer/` - управління клієнтами
- `/api/orders/` - управління замовленнями
- `/api/users/` - інформація про користувачів
- `/login/`, `/logout/` - аутентифікація через Knox

### Система дозволів

Реалізована система дозволів на основі ролей:
- Клієнти можуть бачити тільки продукти з цінами, та свої замовлення
- Менеджери мають повний доступ до всіх ресурсів
- Використовуються кастомні класи дозволів, такі як `IsManager`, `IsOwnerOrManager`

## Фронтенд (Angular)

### Архітектура

- Використовує сучасний підхід з standalone компонентами
- NgRx для управління станом (actions, reducers, effects, selectors)
- Модульна структура з лінивим завантаженням

### Основні компоненти

1. **Аутентифікація**:
   - Компоненти для входу та реєстрації
   - Сервіс аутентифікації з токенами
   - Інтерцептор для додавання токенів до запитів

2. **Продукти та категорії**:
   - Компоненти для перегляду, створення, редагування продуктів
   - Управління категоріями
   - Управління цінами

3. **Клієнти та замовлення**:
   - Управління клієнтами
   - Створення та перегляд замовлень

### Взаємодія з бекендом

- Використовує HttpClient для запитів до API
- Проксі-конфігурація для перенаправлення запитів на бекенд
- Сервіси для кожного типу ресурсу (ProductService, CategoryService, тощо)

## Особливості проекту

1. **Ієрархічна структура**:
   - Категорії можуть мати підкатегорії

2. **Система цін**:
   - Підтримка періодів дії цін
   - Автоматичне визначення поточної ціни

3. **Ролі та дозволи**:
   - Різні можливості для клієнтів та менеджерів
   - Захист API ендпоінтів на основі ролей

4. **Багатомовність**:
   - Інтерфейс українською мовою
   - Підтримка локалізації

## Технічні деталі

1. **Бекенд**:
   - Django 5.2
   - Django REST Framework
   - Knox для аутентифікації
   - Підтримка SQLite (dev) та PostgreSQL (prod)

2. **Фронтенд**:
   - Angular 19.2.7
   - NgRx для управління станом
   - Angular Material для UI
   - SCSS для стилів

3. **Розгортання**:
   - Різні конфігурації для розробки та продакшену
   - Підтримка змінних середовища через .env файл

## Діаграма моделей даних

```
┌─────────────┐       ┌───────────────┐       ┌───────────────┐
│ CustomUser  │       │ProductCategory│       │    Product    │
├─────────────┤       ├───────────────┤       ├───────────────┤
│ username    │       │ code          │       │ title         │
│ email       │◄──┐   │ icon          │       │ description   │
│ role        │   │   │ title         │   ┌──►│ category      │◄──┐
└─────────────┘   │   │ parent        │◄──┘   │ parent        │   |
        ▲         │   └───────────────┘       └───────────────┘   |
        │         │                                   ▲           |
        │         │                                   │           |
┌─────────────┐   │                           ┌───────────────┐   |
│  Customer   │   │                           │     Price     │   | 
├─────────────┤   │                           ├───────────────┤   |
│ user        │───┘                           │ product       │   |
│ code        │                               │ value         │   |
│ name        │                               │ valid_from    │   |
│ phone_no    │                               │ valid_to      │   |
└─────────────┘                               │ is_active     │   |
        ▲                                     └───────────────┘   |
        │                                                         |
        │                                                         | 
┌─────────────┐                         ┌───────────────┐         |
│    Order    │                         │   OrderItem   │         |
├─────────────┤                         ├───────────────┤         | 
│ customer    │────────────────────────►│ order         │         |  
│ status      │                         │ product       │─────────┘ 
│ products    │◄────────────────────────│ quantity      │          
└─────────────┘                         │ price_at_time │          
                                        └───────────────┘          
                                                              

```

## Запуск проекту

### Бекенд
```bash
# Активація віртуального середовища
cd backend
source env/Scripts/activate  # Windows
# source env/bin/activate    # Linux/Mac

# Запуск сервера розробки
python manage.py runserver
```

### Фронтенд
```bash
# Перехід у директорію фронтенду
cd frontend

# Встановлення залежностей (якщо потрібно)
npm install

# Запуск сервера розробки
ng serve
```

Після запуску, фронтенд буде доступний за адресою http://localhost:4200, 
а бекенд - http://localhost:8000.
